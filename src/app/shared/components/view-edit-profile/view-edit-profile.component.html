<div class="profile-container">
  <div class="profile-header">
    <h1 class="profile-title">Profile Settings</h1>
  </div>

  <div class="profile-content" *ngIf="!loading; else loadingTemplate">
    <form [formGroup]="profileForm">
      <div class="section-title">Company Information</div>
      <div class="form-row">
        <div class="form-group">
          <label for="businessName" class="required">Business Name</label>
          <input
            pInputText
            type="text"
            maxlength="255"
            id="businessName"
            formControlName="businessName"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-business-name"
            [control]="profileForm.get('businessName')"
          ></app-error>
        </div>

        <div class="form-group">
          <label for="identificationNumber" class="required"
            >Identification Number</label
          >
          <input
            pInputText
            type="text"
            id="identificationNumber"
            formControlName="identificationNumber"
            [disabled]="true"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="industry" class="required">Industry</label>
          <input
            pInputText
            type="text"
            id="industry"
            formControlName="industry"
            [readonly]="!isEditMode"
            uiTextOnly
          />
          <app-error
            id="error-msg-industry"
            [control]="profileForm.get('industry')"
          ></app-error>
        </div>

        <div class="form-group">
          <label for="websiteUrl">Website</label>
          <input
            pInputText
            type="text"
            id="websiteUrl"
            formControlName="websiteUrl"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-website"
            [control]="profileForm.get('websiteUrl')"
          ></app-error>
        </div>
      </div>

      <div class="section-title">Contact</div>
      <div class="form-row">
        <div class="form-group">
          <label for="email" class="required">Email</label>
          <input
            type="email"
            pInputText
            formControlName="email"
            class="w-full input-form"
            id="inp-email"
            maxLength="255"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-email"
            [control]="profileForm.get('email')"
          ></app-error>
        </div>

        <div class="form-group">
          <label for="phone" class="required">Phone</label>
          <p-inputMask
            mask="+1 999 999 9999"
            formControlName="phone"
            id="phone"
            [readonly]="!isEditMode"
            class="w-full"
          >
          </p-inputMask>
          <app-error
            id="error-msg-phone"
            [control]="profileForm.get('phone')"
          ></app-error>
        </div>
      </div>

      <div class="section-title">Owner Information</div>
      <div class="form-row">
        <div class="form-group">
          <label for="ownerFirstName" class="required">Owner First Name</label>
          <input
            pInputText
            type="text"
            id="ownerFirstName"
            formControlName="ownerFirstName"
            [readonly]="!isEditMode"
            maxlength="50"
            uiTextOnly
          />
          <app-error
            id="error-msg-owner-first-name"
            [control]="profileForm.get('ownerFirstName')"
          ></app-error>
        </div>

        <div class="form-group">
          <label for="ownerLastName">Owner Last Name</label>
          <input
            pInputText
            type="text"
            id="ownerLastName"
            formControlName="ownerLastName"
            [readonly]="!isEditMode"
            uiTextOnly
            maxlength="150"
          />
          <app-error
            id="error-msg-owner-last-name"
            [control]="profileForm.get('ownerLastName')"
          ></app-error>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="ownerEmail">Owner Email</label>
          <input
            pInputText
            type="email"
            id="ownerEmail"
            formControlName="ownerEmail"
            maxLength="255"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-owner-email"
            [control]="profileForm.get('ownerEmail')"
          ></app-error>
        </div>

        <div class="form-group">
          <label for="ownerPhone">Owner Phone</label>
          <p-inputMask
            mask="+1 999 999 9999"
            formControlName="ownerPhone"
            id="ownerPhone"
            [readonly]="!isEditMode"
            class="w-full"
          >
          </p-inputMask>
          <app-error
            id="error-msg-owner-email"
            [control]="profileForm.get('ownerPhone')"
          ></app-error>
        </div>
      </div>

      <div class="section-title">Address</div>
      <div class="form-row">
        <div class="form-group">
          <label htmlFor="street" id="lb-street" class="required">Street</label>
          <input
            type="text"
            pInputText
            formControlName="street"
            class="w-full input-form"
            maxlength="100"
            id="inp-street"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-street"
            [control]="profileForm.get('street')"
          ></app-error>
        </div>

        <div class="form-group">
          <label htmlFor="zipCode" id="lb-zip-code" class="required"
            >ZipCode</label
          >
          <p-inputMask
            mask="99999"
            formControlName="zipCode"
            id="inp-zip-code"
            class="w-full input-form"
            [readonly]="!isEditMode"
          ></p-inputMask>
          <app-error
            id="error-msg-zip-code"
            [control]="profileForm.get('zipCode')"
          ></app-error>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label htmlFor="city" id="lb-city" class="required">City</label>
          <input
            type="text"
            pInputText
            formControlName="city"
            placeholder="City"
            class="w-full input-form"
            maxlength="50"
            id="inp-city"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-city"
            [control]="profileForm.get('city')"
          ></app-error>
        </div>

        <div class="form-group">
          <label htmlFor="state" id="lb-state" class="required">State</label>
          <input
            type="text"
            pInputText
            formControlName="state"
            class="w-full input-form"
            minlength="2"
            maxlength="2"
            id="inp-state"
            uiTextOnly
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-state"
            [control]="profileForm.get('state')"
          ></app-error>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label htmlFor="country" id="lb-country">Country</label>
          <input
            type="text"
            pInputText
            formControlName="country"
            placeholder="Country"
            class="w-full input-form"
            maxlength="100"
            uiTextOnly
            id="inp-country"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-country"
            [control]="profileForm.get('country')"
          ></app-error>
        </div>

        <div class="form-group">
          <label htmlFor="complement" id="lb-complement">Complement</label>
          <input
            type="text"
            pInputText
            formControlName="complement"
            placeholder="Complement"
            class="w-full input-form"
            maxlength="100"
            id="inp-complement"
            [readonly]="!isEditMode"
          />
          <app-error
            id="error-msg-complement"
            [control]="profileForm.get('complement')"
          ></app-error>
        </div>
      </div>

      <div class="section-title">Social Media</div>

      <div formArrayName="socialMedia">
        <div class="social-media-header">
          <label>Social Media Links</label>
          <button
            *ngIf="isEditMode"
            type="button"
            class="btn-add-social"
            (click)="addSocialMedia()"
          >
            <icon-plus></icon-plus>
            Add Social Media
          </button>
        </div>

        <div
          *ngIf="socialMediaArray.length === 0 && !isEditMode"
          class="no-social-media"
        >
          No social media links added.
        </div>

        <div
          *ngIf="socialMediaArray.length === 0 && isEditMode"
          class="no-social-media-edit"
        >
          <p>
            No social media links added yet. Click the button above to add your
            first social media link.
          </p>
        </div>

        <div
          *ngFor="let social of socialMediaArray.controls; let i = index"
          [formGroupName]="i"
          class="form-row social-media-row"
        >
          <div class="form-group">
            <p-dropdown
              [options]="socialMediaOptions"
              formControlName="platform"
              placeholder="Select Social Media"
              [disabled]="!isEditMode"
              class="w-full social-dropdown"
            >
            </p-dropdown>
            <app-error
              *ngIf="
                social.get('platform')?.touched &&
                social.get('platform')?.invalid
              "
              [control]="social.get('platform')"
            ></app-error>
          </div>

          <div class="form-group">
            <input
              type="url"
              formControlName="url"
              placeholder="https://www.example.com"
              [readonly]="!isEditMode"
              class="w-full input-form"
            />
            <app-error
              *ngIf="social.get('url')?.touched && social.get('url')?.invalid"
              [control]="social.get('url')"
            ></app-error>
          </div>

          <button
            pButton
            icon="pi pi-trash"
            *ngIf="isEditMode"
            type="button"
            class="btn-remover-social p-button-danger ml-2 icon-button btn-danger"
            (click)="removeSocialMedia(i)"
          >
            <!-- <i class="pi pi-trash"></i> -->
          </button>
        </div>
      </div>

      <div class="button-container">
        <ng-container *ngIf="!isEditMode">
          <button pButton class="btn-edit" (click)="toggleEditMode()">
            Edit
          </button>
        </ng-container>
        <ng-container *ngIf="isEditMode">
          <button
            pButton
            class="btn-cancel"
            id="btnSecundario"
            (click)="cancelEdit()"
          >
            Cancel
          </button>
          <button pButton class="btn-save" (click)="saveProfile()">Save</button>
        </ng-container>
      </div>
    </form>
  </div>

  <ng-template #loadingTemplate>
    <div class="loading-indicator">
      <p>Loading profile information...</p>
    </div>
  </ng-template>
</div>
