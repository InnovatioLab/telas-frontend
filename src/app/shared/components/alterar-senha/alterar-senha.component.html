<div class="container">
  <div class="card">
    <div class="card-content">
      <h1 class="titulo">Change Password</h1>
      
      <form [formGroup]="formSenha" (ngSubmit)="alterarSenha()">
        <div class="password-field">
          <label for="senhaAtual" class="margin-label">Current Password</label>
          <div class="password-container">
            <input 
              [type]="senhaAtualVisivel ? 'text' : 'password'" 
              id="senhaAtual" 
              formControlName="senhaAtual" 
              class="password-input" 
              [ngClass]="{'is-invalid': formSenha.get('senhaAtual')?.invalid && formSenha.get('senhaAtual')?.touched}"
              placeholder="Enter your current password">
            <button type="button" class="password-toggle" (click)="toggleSenha('senhaAtual')">
              <app-icon-olho *ngIf="!senhaAtualVisivel"></app-icon-olho>
              <app-icon-olho-fechado *ngIf="senhaAtualVisivel"></app-icon-olho-fechado>
            </button>
          </div>
          <div *ngIf="formSenha.get('senhaAtual')?.invalid && formSenha.get('senhaAtual')?.touched" class="invalid-feedback">
            Current password is required
          </div>
        </div>
        
        <div class="password-field">
          <label for="novaSenha" class="margin-label">New Password</label>
          <div class="password-container">
            <input 
              [type]="senhaVisivel ? 'text' : 'password'" 
              id="novaSenha" 
              formControlName="novaSenha" 
              class="password-input" 
              [ngClass]="{'is-invalid': formSenha.get('novaSenha')?.invalid && formSenha.get('novaSenha')?.touched}"
              placeholder="Enter your new password">
            <button type="button" class="password-toggle" (click)="toggleSenha('novaSenha')">
              <app-icon-olho *ngIf="!senhaVisivel"></app-icon-olho>
              <app-icon-olho-fechado *ngIf="senhaVisivel"></app-icon-olho-fechado>
            </button>
          </div>
          <div *ngIf="formSenha.get('novaSenha')?.invalid && formSenha.get('novaSenha')?.touched" class="invalid-feedback">
            <span *ngIf="formSenha.get('novaSenha')?.errors?.['required']">New password is required</span>
            <span *ngIf="formSenha.get('novaSenha')?.errors?.['minlength']">Password must be at least 8 characters</span>
          </div>
          <div class="password-requirements">
            Password must contain at least 8 characters
          </div>
        </div>
        
        <div class="password-field">
          <label for="confirmacaoSenha" class="margin-label">Confirm New Password</label>
          <div class="password-container">
            <input 
              [type]="confirmacaoVisivel ? 'text' : 'password'" 
              id="confirmacaoSenha" 
              formControlName="confirmacaoSenha" 
              class="password-input" 
              [ngClass]="{'is-invalid': formSenha.get('confirmacaoSenha')?.invalid && formSenha.get('confirmacaoSenha')?.touched}"
              placeholder="Confirm your new password">
            <button type="button" class="password-toggle" (click)="toggleSenha('confirmacaoSenha')">
              <app-icon-olho *ngIf="!confirmacaoVisivel"></app-icon-olho>
              <app-icon-olho-fechado *ngIf="confirmacaoVisivel"></app-icon-olho-fechado>
            </button>
          </div>
          <div *ngIf="formSenha.get('confirmacaoSenha')?.invalid && formSenha.get('confirmacaoSenha')?.touched" class="invalid-feedback">
            <span *ngIf="formSenha.get('confirmacaoSenha')?.errors?.['required']">Password confirmation is required</span>
            <span *ngIf="formSenha.get('confirmacaoSenha')?.errors?.['senhasDiferentes']">Passwords do not match</span>
          </div>
        </div>
        
        <div class="btn-senha-salvar">
          <button type="submit" [disabled]="formSenha.invalid || loading">
            {{ loading ? 'Updating...' : 'Update Password' }}
          </button>
        </div>
      </form>
      
      <p-toast position="top-right"></p-toast>
    </div>
  </div>
</div>
