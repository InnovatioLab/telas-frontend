<div class="sidebar-mapa">
  <p-sidebar
    [showCloseIcon]="false"
    [(visible)]="visibilidadeSidebar"
    position="right"
    [dismissible]="true"
    (onHide)="fecharSidebar()"
    [blockScroll]="true"
    [closeOnEscape]="false"
  >
    <ng-template pTemplate="header">
      <div class="flex align-items-center gap-2 w-full">
        <button (click)="voltar()" class="botao-voltar flex-none cursor-pointer" pTooltip="Back" tooltipPosition="right">
          <span class="material-symbols-outlined botao-icon">arrow_back</span>
        </button>
        <div class="flex line-height-1 gap-2 justify-content-center align-items-center w-full">
          <app-icon-tv-display width="24" height="24" fill="var(--cor-primaria)"></app-icon-tv-display>
          <span class="font-bold">{{ pontoSelecionado?.title || 'TV Display' }}</span>
        </div>
      </div>
    </ng-template>
    
    <div class="ponto-detalhes" *ngIf="pontoSelecionado">
      <h3 class="ponto-titulo">{{ pontoSelecionado.title || 'Selected Location' }}</h3>
      
      <div class="street-view-container">
        <div *ngIf="carregandoImagem" class="street-view-loading">
          <i class="pi pi-spin pi-spinner"></i>
          <span>Loading street view...</span>
        </div>
        
        <div *ngIf="erroImagem" class="street-view-error">
          <span class="material-symbols-outlined">image_not_supported</span>
          <p>Street view not available for this location</p>
        </div>
        
        <img *ngIf="!carregandoImagem && !erroImagem && streetViewUrl" 
            [src]="streetViewUrl" 
            alt="Street View" 
            class="street-view-image" 
            (error)="tratarErroImagem()">
      </div>
      
      <div class="ponto-info">
        <div class="info-grupo">
          <span class="material-symbols-outlined">location_on</span>
          <div class="info-detalhe">
            <span class="info-label">Location</span>
            <span class="info-valor">{{ pontoSelecionado.latitude.toFixed(6) }}, {{ pontoSelecionado.longitude.toFixed(6) }}</span>
          </div>
        </div>

        <div *ngIf="pontoSelecionado.description" class="info-grupo">
          <span class="material-symbols-outlined">description</span>
          <div class="info-detalhe">
            <span class="info-label">Description</span>
            <span class="info-valor">{{ pontoSelecionado.description }}</span>
          </div>
        </div>

        <div *ngIf="pontoSelecionado.type" class="info-grupo">
          <app-icon-tv-display width="18" height="18" fill="var(--cor-primaria)"></app-icon-tv-display>
          <div class="info-detalhe">
            <span class="info-label">Display Type</span>
            <span class="info-valor">{{ pontoSelecionado.type || 'Standard' }}</span>
          </div>
        </div>
      </div>

      <div class="acoes-container">
        <button pButton 
                label="View in Google Maps" 
                icon="pi pi-map" 
                class="p-button p-button-secondary" 
                (click)="abrirGoogleMaps()"></button>
        <button pButton 
                label="Select This Location" 
                icon="pi pi-check" 
                class="p-button"></button>
      </div>
    </div>
    
    <div class="sem-ponto" *ngIf="!pontoSelecionado">
      <p>No point selected.</p>
    </div>
  </p-sidebar>
</div>
