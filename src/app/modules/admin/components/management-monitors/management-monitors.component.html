<div class="container">
  <div class="header">
    <h1>Monitor Management</h1>
    <p-button label="Create Monitor" icon="pi pi-plus" (click)="createMonitor()"></p-button>
  </div>

  <div class="content">
    <p-card styleClass="mb-4">
      <div class="filters">
        <span class="p-input-icon-left">
          <i class="pi pi-search"></i>
          <input type="text" pInputText placeholder="Search monitors..." />
        </span>
        <p-dropdown [options]="[{label: 'All', value: ''}, {label: 'Active', value: 'active'}, {label: 'Inactive', value: 'inactive'}]" placeholder="Filter by status"></p-dropdown>
      </div>
    </p-card>

    <p-table [value]="monitors" [loading]="loading" styleClass="p-datatable-sm" [paginator]="true" [rows]="10" 
             [rowsPerPageOptions]="[5,10,25,50]" [showCurrentPageReport]="true" responsiveLayout="scroll"
             currentPageReportTemplate="Showing {first} to {last} of {totalRecords} monitors">
      <ng-template pTemplate="header">
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Status</th>
          <th>Last Update</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-monitor>
        <tr>
          <td>{{monitor.id}}</td>
          <td>{{monitor.name}}</td>
          <td>
            <p-badge [value]="monitor.status" [severity]="monitor.status === 'active' ? 'success' : 'danger'"></p-badge>
          </td>
          <td>{{monitor.lastUpdate | date:'medium'}}</td>
          <td>
            <div class="action-buttons">
              <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success p-button-text" 
                      (click)="onSelectMonitor(monitor)"></button>
              <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger p-button-text" 
                      (click)="deleteMonitor(monitor.id)"></button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5" class="text-center">No monitors found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Dialog for details/edit/create -->
  <p-dialog header="Monitor Details" [(visible)]="dialogVisible" [style]="{width: '450px'}" [modal]="true">
    <div class="monitor-form" *ngIf="selectedMonitor">
      <div class="p-field">
        <label for="name">Name</label>
        <input type="text" pInputText id="name" [(ngModel)]="selectedMonitor.name" />
      </div>
      <div class="p-field">
        <label for="status">Status</label>
        <p-dropdown id="status" [options]="[{label: 'Active', value: 'active'}, {label: 'Inactive', value: 'inactive'}]" 
                   [(ngModel)]="selectedMonitor.status" optionLabel="label" optionValue="value"></p-dropdown>
      </div>
    </div>
    <ng-template pTemplate="footer">
      <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text" (click)="selectedMonitor = null"></button>
      <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="updateMonitor(selectedMonitor)"></button>
    </ng-template>
  </p-dialog>
</div>
