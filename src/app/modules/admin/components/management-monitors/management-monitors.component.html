<div class="container">
  <div class="header">
    <h1>Monitor Management</h1>
    <button pButton type="button" label="Create Monitor" icon="pi pi-plus" class="p-button-primary" (click)="createMonitor()"></button>
  </div>

  <div class="search-container">
    <div class="p-inputgroup">
      <input type="text" pInputText [(ngModel)]="searchText" placeholder="Search monitors by name, location or type" (keyup.enter)="searchMonitors()">
      <button type="button" pButton icon="pi pi-search" (click)="searchMonitors()"></button>
      <button type="button" pButton icon="pi pi-times" class="p-button-danger" (click)="clearSearch()" *ngIf="searchText"></button>
    </div>
  </div>

  <div class="content-container">
    <app-table
      [value]="monitors"
      [colunas]="colunas"
      [header]="'Monitors'"
      [subheader]="'Manage your system monitors'"
      [totalRegistros]="totalRecords"
      [mensagemEmpty]="'No monitors found'"
      (visualizar)="visualizarMonitor($event)"
      (editar)="editarMonitor($event)"
      (excluir)="excluirMonitor($event)"
      (pageChange)="onPageChange($event)">
    </app-table>
  </div>

  <p-dialog [(visible)]="showDialog" [style]="{width: '600px'}" [modal]="true" [header]="isCreating ? 'Create Monitor' : 'Edit Monitor'"
            [closeOnEscape]="true" [dismissableMask]="true">
    <div class="monitor-form" *ngIf="monitorForm">
      <form [formGroup]="monitorForm">
        <div class="p-grid p-fluid">
          <div class="p-field mb-3">
            <label for="name">Name</label>
            <input type="text" id="name" pInputText formControlName="name" class="w-full">
            <small class="p-error" *ngIf="monitorForm.get('name')?.invalid && monitorForm.get('name')?.touched">
              Name is required
            </small>
          </div>
          
          <div class="p-field mb-3">
            <label for="location">Location</label>
            <input type="text" id="location" pInputText formControlName="location" class="w-full">
            <small class="p-error" *ngIf="monitorForm.get('location')?.invalid && monitorForm.get('location')?.touched">
              Location is required
            </small>
          </div>
          
          <div class="p-field mb-3">
            <label for="locationDescription">Location Description</label>
            <textarea id="locationDescription" pInputTextarea formControlName="locationDescription" class="w-full" rows="3"></textarea>
          </div>
          
          <div class="p-field mb-3">
            <label for="productId">Product ID</label>
            <input type="text" id="productId" pInputText formControlName="productId" class="w-full">
            <small class="p-error" *ngIf="monitorForm.get('productId')?.invalid && monitorForm.get('productId')?.touched">
              Product ID is required
            </small>
          </div>
          
          <div class="p-field mb-3">
            <label for="size">Size (inches)</label>
            <p-inputNumber id="size" formControlName="size" [min]="1" [max]="200" class="w-full"></p-inputNumber>
            <small class="p-error" *ngIf="monitorForm.get('size')?.invalid && monitorForm.get('size')?.touched">
              Size is required and must be greater than 0
            </small>
          </div>
          
          <div class="p-field mb-3">
            <label for="maxBlocks">Max Blocks</label>
            <p-inputNumber id="maxBlocks" formControlName="maxBlocks" [min]="1" [max]="100" class="w-full"></p-inputNumber>
            <small class="p-error" *ngIf="monitorForm.get('maxBlocks')?.invalid && monitorForm.get('maxBlocks')?.touched">
              Max blocks is required and must be greater than 0
            </small>
          </div>
          
          <div class="p-field mb-3">
            <label for="type">Type</label>
            <p-dropdown id="type" [options]="monitorTypes" formControlName="type" placeholder="Select a type" class="w-full"></p-dropdown>
            <small class="p-error" *ngIf="monitorForm.get('type')?.invalid && monitorForm.get('type')?.touched">
              Type is required
            </small>
          </div>
          
          <div class="p-field mb-3">
            <label for="status">Status</label>
            <p-dropdown id="status" [options]="statusOptions" formControlName="status" optionLabel="label" optionValue="value" placeholder="Select a status" class="w-full"></p-dropdown>
            <small class="p-error" *ngIf="monitorForm.get('status')?.invalid && monitorForm.get('status')?.touched">
              Status is required
            </small>
          </div>
          
          <div class="p-field mb-3">
            <label for="active" class="p-checkbox-label">Active</label>
            <p-checkbox id="active" formControlName="active" [binary]="true"></p-checkbox>
          </div>
        </div>
      </form>
    </div>
    
    <ng-template pTemplate="footer">
      <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
      <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="saveMonitor()" [disabled]="monitorForm?.invalid"></button>
    </ng-template>
  </p-dialog>
</div>
