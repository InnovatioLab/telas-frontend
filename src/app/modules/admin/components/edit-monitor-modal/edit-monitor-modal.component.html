<div class="edit-monitor-modal">
  <div class="modal-header">
    <h2>Edit Screen</h2>
    <button
      pButton
      pRipple
      icon="pi pi-times"
      class="p-button-rounded p-button-text p-button-secondary close-btn"
      (click)="cancel()"
    ></button>
  </div>

  <form [formGroup]="monitorForm" (ngSubmit)="submit()" class="modal-content">
    <div class="form-section">
      <h3>Screen Information</h3>

      <div class="form-row">
        <div class="form-field">
          <label for="size" class="required">Size (inches)</label>
          <p-inputNumber
            id="size"
            formControlName="size"
            [min]="0.01"
            [max]="999.99"
            [minFractionDigits]="2"
            [maxFractionDigits]="2"
            placeholder="Enter size"
          >
          </p-inputNumber>
          <small class="error-message" *ngIf="getFieldError('size')">{{
            getFieldError("size")
          }}</small>
        </div>

        <div class="form-field">
          <label for="type" class="required">Type</label>
          <p-dropdown
            id="type"
            formControlName="type"
            [options]="monitorTypes"
            placeholder="Select screen type"
          >
          </p-dropdown>
          <small class="error-message" *ngIf="getFieldError('type')">{{
            getFieldError("type")
          }}</small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="active">Status</label>
          <div
            class="status-toggle-row"
            style="display: flex; align-items: center"
          >
            <p-inputSwitch id="active" formControlName="active">
            </p-inputSwitch>
            <span
              class="status-label"
              style="margin-left: 1rem; font-weight: bold"
              [ngStyle]="{
                color: monitorForm.get('active')?.value ? '#388e3c' : '#d32f2f',
              }"
            >
              {{ monitorForm.get("active")?.value ? "Active" : "Inactive" }}
            </span>
          </div>
          <small class="error-message" *ngIf="getFieldError('active')">{{
            getFieldError("active")
          }}</small>
        </div>

        <div class="form-field">
          <label for="locationDescription">Location Description</label>
          <textarea
            pInputTextarea
            id="locationDescription"
            formControlName="locationDescription"
            placeholder="Enter location description"
            rows="3"
          >
          </textarea>
          <small
            class="error-message"
            *ngIf="getFieldError('locationDescription')"
            >{{ getFieldError("locationDescription") }}</small
          >
        </div>
      </div>
    </div>

    <div class="form-section">
      <h3>Address Information</h3>

      <div formGroupName="address" class="address-group">
        <div class="form-row">
          <div class="form-field">
            <label for="zipCode" class="required">ZipCode</label>
            <div class="zipcode-input-container">
              <input
                pInputText
                id="zipCode"
                formControlName="zipCode"
                placeholder="Enter 5-digit zip code"
                maxlength="5"
                pKeyFilter="int"
              />
              <i
                *ngIf="loadingZipCode"
                class="pi pi-spin pi-spinner loading-icon"
              ></i>
            </div>
            <small class="help-text"
              >Enter the zip code to automatically fill city and state</small
            >
            <small
              class="error-message"
              *ngIf="getFieldError('address', 'zipCode')"
              >{{ getFieldError("address", "zipCode") }}</small
            >
          </div>

          <div class="form-field">
            <label for="street" class="required">Street</label>
            <input
              pInputText
              id="street"
              formControlName="street"
              placeholder="Enter street"
            />
            <small
              class="error-message"
              *ngIf="getFieldError('address', 'street')"
              >{{ getFieldError("address", "street") }}</small
            >
          </div>
        </div>

        <div class="form-row">
          <div class="form-field">
            <label for="city" class="required">City</label>
            <input
              pInputText
              id="city"
              formControlName="city"
              placeholder="Enter city"
            />
            <small
              class="error-message"
              *ngIf="getFieldError('address', 'city')"
              >{{ getFieldError("address", "city") }}</small
            >
          </div>

          <div class="form-field">
            <label for="state" class="required">State</label>
            <input
              pInputText
              id="state"
              formControlName="state"
              placeholder="Enter 2-letter state code"
              maxlength="2"
            />
            <small
              class="error-message"
              *ngIf="getFieldError('address', 'state')"
              >{{ getFieldError("address", "state") }}</small
            >
          </div>
        </div>

        <div class="form-row">
          <div class="form-field">
            <label for="country">Country</label>
            <input
              pInputText
              id="country"
              formControlName="country"
              placeholder="Enter country"
            />
            <small
              class="error-message"
              *ngIf="getFieldError('address', 'country')"
              >{{ getFieldError("address", "country") }}</small
            >
          </div>

          <div class="form-field">
            <label for="complement">Complement</label>
            <input
              pInputText
              id="complement"
              formControlName="complement"
              placeholder="Enter complement"
            />
            <small
              class="error-message"
              *ngIf="getFieldError('address', 'complement')"
              >{{ getFieldError("address", "complement") }}</small
            >
          </div>
        </div>
      </div>
    </div>

    <div
      class="form-actions"
      style="
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 1rem;
      "
    >
      <button
        pButton
        pRipple
        type="button"
        id="btnSecundario"
        label="Cancel"
        class="p-button-outlined"
        (click)="cancel()"
      ></button>
      <button
        pButton
        pRipple
        type="submit"
        label="Update Screen"
        [disabled]="monitorForm.invalid"
      ></button>
    </div>
  </form>
</div>
