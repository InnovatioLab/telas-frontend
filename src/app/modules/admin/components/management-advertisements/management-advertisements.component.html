<div class="container">
  <div class="content">
    <p-card styleClass="card-header">
      <div class="card-header-content">
          <i class="pi pi-search"></i>
          <div class="p-card-content">
            <span class="p-input-icon-left">
              <app-icon-search></app-icon-search>
              <input 
                type="text" 
                pInputText 
                placeholder="Search advertisements..." 
                [(ngModel)]="searchTerm"
                [ngModelOptions]="{standalone: true}"
                (keyup.enter)="onSearch()" />
            </span>
            <p-button 
              label="Create Advertisement" 
              icon="pi pi-plus" 
              (click)="createAdvertisement()"
              onKeyDown="createAdvertisement()"></p-button>
          </div>
      </div>
    </p-card>

    <p-table 
      [value]="advertisements" 
      [loading]="loading" 
      styleClass="p-datatable-sm" 
      [paginator]="true" 
      [rows]="pageSize" 
      [totalRecords]="totalRecords"
      [rowsPerPageOptions]="[5,10,25,50]" 
      [showCurrentPageReport]="true" 
      responsiveLayout="scroll"
      [lazy]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} advertisements"
      (onPage)="onPageChange($event)">
      <ng-template pTemplate="header">
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Link</th>
          <th scope="col">Status</th>
          <th scope="col">Submission Date</th>
          <th scope="col">Waiting Days</th>
          <th scope="col">Actions</th>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="body" let-ad>
        <tr>
          <td class="text-center">{{ad.id?.substring(0, 8) || 'N/A'}}</td>
          <td class="text-center">
            <a [href]="ad.link" target="_blank" class="ad-link">
              {{ad.link || 'No link'}}
            </a>
          </td>
          <td class="text-center">
            <p-badge 
              [value]="getStatusLabel(ad.validation)" 
              [severity]="getStatusSeverity(ad.validation)">
            </p-badge>
          </td>
          <td class="text-center">{{ad.submissionDate | date:'short'}}</td>
          <td class="text-center">{{ad.waitingDays || 0}} days</td>
          <td class="text-center">
            <div class="action-buttons">
              <button pButton pRipple 
                      icon="pi pi-check" 
                      class="p-button-rounded p-button-success p-button-text" 
                      (click)="approveAdvertisement(ad)"
                      pTooltip="Approve Advertisement"
                      [disabled]="ad.validation?.toLowerCase() === 'approved'">
              </button>
              <button pButton pRipple 
                      icon="pi pi-times" 
                      class="p-button-rounded p-button-warning p-button-text" 
                      (click)="rejectAdvertisement(ad)"
                      pTooltip="Reject Advertisement"
                      [disabled]="ad.validation?.toLowerCase() === 'rejected'">
              </button>
              <button pButton pRipple 
                      icon="pi pi-trash" 
                      class="p-button-rounded p-button-danger p-button-text" 
                      (click)="deleteAdvertisement(ad)"
                      pTooltip="Delete Advertisement">
              </button>
            </div>
          </td>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center">No advertisements found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div> 